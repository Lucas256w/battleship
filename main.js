(()=>{"use strict";const e=class{constructor(e,t){this.length=e,this.timesHit=0,this.sunked=!1,this.isHorizontal=!0,this.name=t}hit(){this.timesHit+=1,this.isSunk()}isSunk(){this.sunked=this.timesHit===this.length}rotate(){!0===this.isHorizontal?this.isHorizontal=!1:this.isHorizontal=!0}},t=class{constructor(e,t,a){this.isComputer=a,this.gameboard=e,this.enemyGameboard=t}takeTurn(e,t){this.isComputer?this.makeRandomMove():this.enemyGameboard.receiveAttack(e,t)}makeRandomMove(){let e=!1;for(;!1===e;)e=this.enemyGameboard.receiveAttack(Math.floor(10*Math.random()),Math.floor(10*Math.random()))}},a=class{constructor(){this.grid=this.makeGrid(),this.gameOver=!1}makeGrid(){const e=[];for(let t=0;t<10;t+=1){const t=[];for(let e=0;e<10;e+=1)t.push(0);e.push(t)}return e}placeShip(e,t,a,o){for(let i=0;i<e.length;i+=1){if(o&&(void 0===this.grid[t][a+i]||0!==this.grid[t][a+i]))return!1;if(!o){try{this.grid[t+i][a]}catch(e){return!1}if(0!==this.grid[t+i][a])return!1}}for(let i=0;i<e.length;i+=1)o?this.grid[t][a+i]=e:this.grid[t+i][a]=e;return!0}receiveAttack(e,t){return"miss"!==this.grid[e][t]&&"hit"!==this.grid[e][t]&&(0===this.grid[e][t]?(this.grid[e][t]="miss",!0):(this.grid[e][t].hit(),this.grid[e][t]="hit",this.isGameOver(),!0))}isGameOver(){let t=!1;for(let a=0;a<10;a+=1)for(let o=0;o<10;o+=1)this.grid[a][o]instanceof e&&(t=!0);this.gameOver=!t}},o=[new e(5,"Carrier"),new e(4,"BattleShip"),new e(3,"Destroyer"),new e(3,"Submarine"),new e(2,"Patrol Boat")];(class{static activateUI(){console.log("hello");const e=document.querySelector("#gameboard-one"),t=document.querySelector("#gameboard-two"),[a,i]=this.generatePlayers();this.generatePlayerGrid(e,a),this.generateEnemyGrid(t,i,e,a),this.generateEnemyShips(i),this.placeShipDialog(e,a,o.pop())}static generatePlayerGrid(t,a){t.innerHTML="";for(let o=0;o<10;o+=1){const i=document.createElement("div");i.className="cell-row";for(let t=0;t<10;t+=1){const r=document.createElement("div");r.className="cell-column",a.gameboard.grid[o][t]instanceof e?r.classList.add("ship"):r.classList.add(a.gameboard.grid[o][t]),i.appendChild(r)}t.appendChild(i)}}static generateEnemyGrid(e,t,a,o){const i=document.querySelector("#winner-dialog"),r=document.querySelector("#winner-title");document.querySelector("#play-again-btn").addEventListener("click",(()=>{location.reload()}));for(let s=0;s<10;s+=1){const n=document.createElement("div");n.className="cell-row";for(let e=0;e<10;e+=1){const l=document.createElement("div");l.className="cell-column",l.addEventListener("click",(()=>{l.classList.contains("hit")||l.classList.contains("miss")||(t.gameboard.receiveAttack(s,e),l.classList.add(t.gameboard.grid[s][e]),t.gameboard.gameOver&&(i.showModal(),r.textContent="Congratulations You've Won!",i.style.display="flex"),t.takeTurn(),this.generatePlayerGrid(a,o),o.gameboard.gameOver&&(i.showModal(),r.textContent="Oh No You've Lost!",i.style.display="flex"))})),n.appendChild(l)}e.appendChild(n)}}static generateEnemyShips(t){const a=[new e(5),new e(4),new e(3),new e(3),new e(2)];let o=0;for(;o<5;)t.gameboard.placeShip(a[o],Math.floor(10*Math.random()),Math.floor(10*Math.random()),Math.random()<.5)&&(o+=1)}static generatePlayers(){const e=new a,o=new a;return[new t(e,o,!1),new t(o,e,!0)]}static placeShipDialog(t,a,i){const r=document.querySelector("#placement-dialog");r.showModal();const s=document.querySelector("#placement-grid");document.querySelector("#dialog-title").textContent=`Place your ${i.name}`,document.querySelector("#rotate-button").addEventListener("click",(()=>{i.rotate()})),s.innerHTML="";for(let n=0;n<10;n+=1){const l=document.createElement("div");l.className="placement-row";for(let s=0;s<10;s+=1){const c=document.createElement("div");c.className="placement-column",c.setAttribute("Coordinate",`${n}${s}`),a.gameboard.grid[n][s]instanceof e&&c.classList.add("ship"),c.addEventListener("mouseover",(()=>{for(let e=i.length-1;e>=0;e-=1)try{i.isHorizontal?document.querySelector(`[Coordinate="${n}${s+e}"]`).classList.add("yellow"):document.querySelector(`[Coordinate="${n+e}${s}"]`).classList.add("yellow")}catch(e){console.log("can't place it there");break}})),c.addEventListener("mouseout",(()=>{for(let e=i.length-1;e>=0;e-=1)try{i.isHorizontal?document.querySelector(`[Coordinate="${n}${s+e}"]`).classList.remove("yellow"):document.querySelector(`[Coordinate="${n+e}${s}"]`).classList.remove("yellow")}catch(e){console.log("");break}})),c.addEventListener("click",(()=>{const e=a.gameboard.placeShip(i,n,s,i.isHorizontal);e&&(0===o.length?(r.style.display="none",r.close(),this.generatePlayerGrid(t,a)):this.placeShipDialog(t,a,o.pop())),console.log(e)})),l.appendChild(c)}s.appendChild(l)}}}).activateUI()})();